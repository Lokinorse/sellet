var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function l(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(e,n,o){return e[1]?t({},t(n.$$scope.ctx,e[1](o?o(n):{}))):n.$$scope.ctx}function c(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function i(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function p(){return f(" ")}function $(){return f("")}function m(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function h(e,t){t=""+t,e.data!==t&&(e.data=t)}let g;function v(e){g=e}const w=[],y=[],x=[],b=[],S=Promise.resolve();let C=!1;function _(e){x.push(e)}function k(){const e=new Set;do{for(;w.length;){const e=w.shift();v(e),E(e.$$)}for(;y.length;)y.pop()();for(let t=0;t<x.length;t+=1){const n=x[t];e.has(n)||(n(),e.add(n))}x.length=0}while(w.length);for(;b.length;)b.pop()();C=!1}function E(e){e.fragment&&(e.update(e.dirty),r(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(_))}const N=new Set;let L;function M(){L={r:0,c:[],p:L}}function O(){L.r||r(L.c),L=L.p}function j(e,t){e&&e.i&&(N.delete(e),e.i(t))}function A(e,t,n,o){if(e&&e.o){if(N.has(e))return;N.add(e),L.c.push(()=>{N.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function P(e,t,o){const{fragment:a,on_mount:s,on_destroy:c,after_update:u}=e.$$;a.m(t,o),_(()=>{const t=s.map(n).filter(l);c?c.push(...t):r(t),e.$$.on_mount=[]}),u.forEach(_)}function D(e,t){e.$$.fragment&&(r(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function I(e,t){e.$$.dirty||(w.push(e),C||(C=!0,S.then(k)),e.$$.dirty=o()),e.$$.dirty[t]=!0}function T(t,n,l,a,s,c){const u=g;v(t);const d=n.props||{},i=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:null};let f=!1;var p;i.ctx=l?l(t,d,(e,n,o=n)=>(i.ctx&&s(i.ctx[e],i.ctx[e]=o)&&(i.bound[e]&&i.bound[e](o),f&&I(t,e)),n)):d,i.update(),f=!0,r(i.before_update),i.fragment=a(i.ctx),n.target&&(n.hydrate?i.fragment.l((p=n.target,Array.from(p.childNodes))):i.fragment.c(),n.intro&&j(t.$$.fragment),P(t,n.target,n.anchor),k()),v(u)}class q{$destroy(){D(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const B=window.location.origin.includes("localhost"),F="https://sellet.ru",H=B?"/sellet_widget.css":"https://sellet.ru/widget/sellet_widget.css",{Object:z}=window;function G(e){var t=new FormData;if(window.localStorage)return z.keys(e).map(n=>{var o=e[n];t.append(n,o)}),t}function J(t){var n;return{c(){(n=i("div")).innerHTML='<div class="lds-ring svelte-anuude"><div class="svelte-anuude"></div><div class="svelte-anuude"></div><div class="svelte-anuude"></div><div class="svelte-anuude"></div></div>',m(n,"class","sellet-preloader-wrapper svelte-anuude")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}class K extends q{constructor(e){super(),T(this,e,null,J,a,[])}}function Q(e){var n,o,r,l,a,$,g,v,w,y;const x=e.$$slots.default,b=function(e,t,n){if(e){const o=s(e,t,n);return e[0](o)}}(x,e,null);return{c(){var t,s,c,u;n=i("div"),o=i("div"),(r=i("div")).textContent="×",l=p(),a=i("div"),$=f(e.header),g=p(),v=i("div"),b&&b.c(),m(r,"class","sellet-modal-close svelte-e8lohn"),m(a,"class","sellet-modal-header svelte-e8lohn"),m(v,"class","sellet-modal-content svelte-e8lohn"),m(o,"class","sellet-modal-inner-wrapper svelte-e8lohn"),m(n,"class","sellet-modal-wrapper svelte-e8lohn"),t=r,s="click",c=e.onClose,t.addEventListener(s,c,u),y=(()=>t.removeEventListener(s,c,u))},l(e){b&&b.l(div2_nodes)},m(e,t){u(e,n,t),c(n,o),c(o,r),c(o,l),c(o,a),c(a,$),c(o,g),c(o,v),b&&b.m(v,null),w=!0},p(e,n){w&&!e.header||h($,n.header),b&&b.p&&e.$$scope&&b.p(function(e,n,o,r){return e[1]?t({},t(n.$$scope.changed||{},e[1](r?r(o):{}))):n.$$scope.changed||{}}(x,n,e,null),s(x,n,null))},i(e){w||(j(b,e),w=!0)},o(e){A(b,e),w=!1},d(e){e&&d(n),b&&b.d(e),y()}}}function R(e,t,n){let{header:o,onClose:r}=t,{$$slots:l={},$$scope:a}=t;return e.$set=(e=>{"header"in e&&n("header",o=e.header),"onClose"in e&&n("onClose",r=e.onClose),"$$scope"in e&&n("$$scope",a=e.$$scope)}),{header:o,onClose:r,$$slots:l,$$scope:a}}class U extends q{constructor(e){super(),T(this,e,R,Q,a,["header","onClose"])}}function V(e,t,n){const o=Object.create(e);return o.error=t[n],o}function W(e){var t,n=new U({props:{header:"Ошибка!",onClose:e.handleCloseModal,$$slots:{default:[Y]},$$scope:{ctx:e}}});return{c(){n.$$.fragment.c()},m(e,o){P(n,e,o),t=!0},p(e,t){var o={};(e.$$scope||e.modalState)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(j(n.$$.fragment,e),t=!0)},o(e){A(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function X(e){var t,n,o=e.error+"";return{c(){t=i("div"),n=f(o),m(t,"class","sellet-error-message")},m(e,o){u(e,t,o),c(t,n)},p(e,t){e.modalState&&o!==(o=t.error+"")&&h(n,o)},d(e){e&&d(t)}}}function Y(e){var t;let n=e.modalState.errors,o=[];for(let t=0;t<n.length;t+=1)o[t]=X(V(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=$()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);u(e,t,n)},p(e,r){if(e.modalState){let l;for(n=r.modalState.errors,l=0;l<n.length;l+=1){const a=V(r,n,l);o[l]?o[l].p(e,a):(o[l]=X(a),o[l].c(),o[l].m(t.parentNode,t))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},d(e){!function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(o,e),e&&d(t)}}}function Z(e){var t,n=new U({props:{header:"Подождите",onClose:e.handleCloseModal,$$slots:{default:[ee]},$$scope:{ctx:e}}});return{c(){n.$$.fragment.c()},m(e,o){P(n,e,o),t=!0},p(e,t){var o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(j(n.$$.fragment,e),t=!0)},o(e){A(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function ee(e){var t,n=new K({});return{c(){n.$$.fragment.c()},m(e,o){P(n,e,o),t=!0},i(e){t||(j(n.$$.fragment,e),t=!0)},o(e){A(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function te(e){var t,n=new U({props:{header:"Спасибо за заказ",onClose:e.handleCloseModal,$$slots:{default:[ne]},$$scope:{ctx:e}}});return{c(){n.$$.fragment.c()},m(e,o){P(n,e,o),t=!0},p(e,t){var o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(j(n.$$.fragment,e),t=!0)},o(e){A(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function ne(e){var t;return{c(){t=f("Наш менеджер свяжется с вами в ближашее время!")},m(e,n){u(e,t,n)},d(e){e&&d(t)}}}function oe(e){var t,n,o,r,l="errors"===e.state&&e.modalState.errors.length&&W(e),a="loading"===e.state&&Z(e),s="thanks"===e.state&&te(e);return{c(){l&&l.c(),t=p(),a&&a.c(),n=p(),s&&s.c(),o=$()},m(e,c){l&&l.m(e,c),u(e,t,c),a&&a.m(e,c),u(e,n,c),s&&s.m(e,c),u(e,o,c),r=!0},p(e,r){"errors"===r.state&&r.modalState.errors.length?l?(l.p(e,r),j(l,1)):((l=W(r)).c(),j(l,1),l.m(t.parentNode,t)):l&&(M(),A(l,1,1,()=>{l=null}),O()),"loading"===r.state?a?(a.p(e,r),j(a,1)):((a=Z(r)).c(),j(a,1),a.m(n.parentNode,n)):a&&(M(),A(a,1,1,()=>{a=null}),O()),"thanks"===r.state?s?(s.p(e,r),j(s,1)):((s=te(r)).c(),j(s,1),s.m(o.parentNode,o)):s&&(M(),A(s,1,1,()=>{s=null}),O())},i(e){r||(j(l),j(a),j(s),r=!0)},o(e){A(l),A(a),A(s),r=!1},d(e){l&&l.d(e),e&&d(t),a&&a.d(e),e&&d(n),s&&s.d(e),e&&d(o)}}}function re(e,t,n){let o=null,r={errors:[]},l={name:null,phone:null,selltype:null,cost:null,offer:null,title:null};async function a(e){const t=function(e){var t=[];return e.name||t.push("Не заполнено имя"),e.phone||t.push("Не заполнен телефон"),e.selltype||t.push("Не задан тип продажи"),e.cost||t.push("Не задано цена"),e.offer||t.push("Не задан оффер"),e.title||t.push("Не задан название товара"),t}(e);if(t.length)n("state",o="errors"),n("modalState",r.errors=t,r);else{n("state",o="loading");await fetch(`${F}/order.php`,{method:"POST",body:G(e)});n("state",o="thanks")}}return document.addEventListener("submit",function(e){"form"!==!e.target.tagName.toLowerCase()&&(e.preventDefault(),e.stopPropagation(),a(function(e){if(window.localStorage)return z.keys(e).map(t=>{var n=e[t];window.localStorage.setItem(t,n)}),e}(l=function(e){for(var t={},n=e.querySelectorAll("input, select, textarea"),o=0;o<n.length;++o){var r=n[o],l=r.name,a=r.value;l&&(t[l]=a)}return t}(this))))},!1),document.addEventListener("click",function(e){e.target.classList.contains("sellet-buy-button")&&(e.preventDefault(),e.stopPropagation(),a(function(e){return e.name&&e.phone||!window.localStorage?e:(z.keys(e).map(t=>{e[t],e[t]=window.localStorage.getItem(t)}),e)}(l)))},!1),{state:o,modalState:r,handleCloseModal:function(){n("state",o=null),n("modalState",r.errors=[],r)}}}let le=document.createElement("div");le.id="sellet-wrapper",document.body.append(le);let ae=document.createElement("link");return ae.href=H,ae.rel="stylesheet",document.head.append(ae),new class extends q{constructor(e){super(),T(this,e,re,oe,a,[])}}({target:document.getElementById("sellet-wrapper")})}();
//# sourceMappingURL=sellet_widget.js.map
